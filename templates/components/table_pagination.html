{% comment %}
Reusable pagination component for tables
Usage: {% include 'components/table_pagination.html' with page_obj=page_obj %}
{% endcomment %}

{% if page_obj %}
<div class="flex flex-col sm:flex-row items-center justify-between gap-4 mt-6">
    <!-- Results count -->
    <div class="text-sm text-gray-600">
        Showing 
        <span class="font-medium">{{ page_obj.start_index }}</span>
        to 
        <span class="font-medium">{{ page_obj.end_index }}</span>
        of 
        <span class="font-medium">{{ page_obj.paginator.count }}</span>
        results
    </div>

    <!-- Pagination controls -->
    {% if page_obj.has_other_pages %}
    <div class="join">
        <!-- Previous button -->
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}{% if request.GET.status %}&status={{ request.GET.status }}{% endif %}{% if request.GET.center %}&center={{ request.GET.center }}{% endif %}" 
               class="join-item btn btn-sm">
                «
            </a>
        {% else %}
            <button class="join-item btn btn-sm btn-disabled">«</button>
        {% endif %}

        <!-- Page numbers -->
        {% for num in page_obj.paginator.page_range %}
            {% if page_obj.number == num %}
                <button class="join-item btn btn-sm btn-active">{{ num }}</button>
            {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <a href="?page={{ num }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}{% if request.GET.status %}&status={{ request.GET.status }}{% endif %}{% if request.GET.center %}&center={{ request.GET.center }}{% endif %}" 
                   class="join-item btn btn-sm">
                    {{ num }}
                </a>
            {% elif num == 1 or num == page_obj.paginator.num_pages %}
                <a href="?page={{ num }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}{% if request.GET.status %}&status={{ request.GET.status }}{% endif %}{% if request.GET.center %}&center={{ request.GET.center }}{% endif %}" 
                   class="join-item btn btn-sm">
                    {{ num }}
                </a>
            {% elif num == page_obj.number|add:'-3' or num == page_obj.number|add:'3' %}
                <button class="join-item btn btn-sm btn-disabled">...</button>
            {% endif %}
        {% endfor %}

        <!-- Next button -->
        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}{% if request.GET.status %}&status={{ request.GET.status }}{% endif %}{% if request.GET.center %}&center={{ request.GET.center }}{% endif %}" 
               class="join-item btn btn-sm">
                »
            </a>
        {% else %}
            <button class="join-item btn btn-sm btn-disabled">»</button>
        {% endif %}
    </div>
    {% endif %}
</div>

<!-- Keyboard navigation script -->
<script>
document.addEventListener('keydown', function(e) {
    {% if page_obj.has_previous %}
    if (e.key === 'ArrowLeft' && !e.target.matches('input, textarea')) {
        window.location.href = '?page={{ page_obj.previous_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}';
    }
    {% endif %}
    {% if page_obj.has_next %}
    if (e.key === 'ArrowRight' && !e.target.matches('input, textarea')) {
        window.location.href = '?page={{ page_obj.next_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}';
    }
    {% endif %}
});
</script>
{% endif %}
